!function(r){var e={};function t(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return r[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var i in r)t.d(n,i,function(e){return r[e]}.bind(null,i));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=0)}([function(r,e,t){r.exports=t(1)},function(r,e,t){"use strict";t.r(e);var n={};t.r(n),t.d(n,"generateN",function(){return R}),t.d(n,"skipN",function(){return C}),t.d(n,"congruential",function(){return A}),t.d(n,"congruential32",function(){return b}),t.d(n,"mersenne",function(){return X}),t.d(n,"xorshift128plus",function(){return k}),t.d(n,"uniformBigIntDistribution",function(){return D}),t.d(n,"uniformIntDistribution",function(){return N});var i={};t.r(i),t.d(i,"assignToRegister",function(){return _});var o={};t.r(o),t.d(o,"bitwiseOr",function(){return Z}),t.d(o,"bitwiseAnd",function(){return z}),t.d(o,"randomBitwiseAnd",function(){return V}),t.d(o,"bitwiseXor",function(){return W}),t.d(o,"shiftRight",function(){return H}),t.d(o,"shiftLeft",function(){return J});var u={};t.r(u),t.d(u,"registerEqualsConstant",function(){return Q}),t.d(u,"registerDoesNotEqualConstant",function(){return $}),t.d(u,"registersAreEqual",function(){return rr}),t.d(u,"registersAreNotEqual",function(){return er});var s={};t.r(s),t.d(s,"setRegisterToConstant",function(){return tr}),t.d(s,"addConstantToRegister",function(){return nr});var a={};t.r(a),t.d(a,"returnFromSubroutine",function(){return ir}),t.d(a,"jumpToAddress",function(){return or}),t.d(a,"callSubroutine",function(){return ur}),t.d(a,"jumpToAddressPlusRegisterZero",function(){return sr});var c={};t.r(c),t.d(c,"clearScreen",function(){return ar}),t.d(c,"drawGraphics",function(){return cr});var f={};t.r(f),t.d(f,"keyIsPressed",function(){return fr}),t.d(f,"keyIsNotPressed",function(){return gr}),t.d(f,"awaitKeyPress",function(){return mr});var g={};t.r(g),t.d(g,"addTwoRegisters",function(){return dr}),t.d(g,"registerXMinusRegisterY",function(){return pr}),t.d(g,"registerYMinusRegisterX",function(){return lr});var m={};t.r(m),t.d(m,"setIndexRegisterToAddress",function(){return vr}),t.d(m,"addRegisterXToIndexRegister",function(){return hr}),t.d(m,"registerDump",function(){return yr}),t.d(m,"registerLoad",function(){return Rr}),t.d(m,"storeBCD",function(){return Cr}),t.d(m,"storeSpriteLocation",function(){return wr});var d={};t.r(d),t.d(d,"setRegisterToDelayTimer",function(){return xr}),t.d(d,"setDelayTimerToRegister",function(){return Tr}),t.d(d,"setSoundTimerToRegister",function(){return Sr});var p=function(){return(p=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r}).apply(this,arguments)};function l(r,e,t,n){return new(t||(t=Promise))(function(i,o){function u(r){try{a(n.next(r))}catch(r){o(r)}}function s(r){try{a(n.throw(r))}catch(r){o(r)}}function a(r){r.done?i(r.value):new t(function(e){e(r.value)}).then(u,s)}a((n=n.apply(r,e||[])).next())})}function v(r,e){var t,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;u;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(r,u)}catch(r){o=[6,r],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(r,e){var t="function"==typeof Symbol&&r[Symbol.iterator];if(!t)return r;var n,i,o=t.call(r),u=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)u.push(n.value)}catch(r){i={error:r}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(i)throw i.error}}return u}function y(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(h(arguments[e]));return r}function R(r,e){for(var t=r,n=[],i=0;i!=e;++i){var o=t.next();n.push(o[0]),t=o[1]}return[n,t]}function C(r,e){return R(r,e)[1]}var w=function(r){return 214013*r+2531011&4294967295},x=function(r){return(r&(1<<31)-1)>>16},T=function(){function r(r){this.seed=r}return r.prototype.min=function(){return r.min},r.prototype.max=function(){return r.max},r.prototype.next=function(){var e=w(this.seed);return[x(e),new r(e)]},r.min=0,r.max=Math.pow(2,15)-1,r}(),S=function(){function r(r){this.seed=r}return r.prototype.min=function(){return r.min},r.prototype.max=function(){return r.max},r.prototype.next=function(){var e=w(this.seed),t=x(e),n=w(e),i=x(n),o=w(n);return[2147483648+(x(o)+(i+(t<<15)<<15)+2147483648|0),new r(o)]},r.min=0,r.max=4294967295,r}(),A=function(r){return new T(r)},b=function(r){return new S(r)};var I=function(){function r(e,t){t>=r.N?(this.states=r.twist(e),this.index=0):(this.states=e,this.index=t)}return r.twist=function(e){for(var t=e.slice(),n=0;n!==r.N;++n){var i=(t[n]&r.MASK_UPPER)+(t[(n+1)%r.N]&r.MASK_LOWER),o=i>>>1;1&i&&(o^=r.A),t[n]=t[(n+r.M)%r.N]^o}return t},r.seeded=function(e){var t,n,i,o,u=Array(r.N);u[0]=e;for(var s=1;s!==r.N;++s){var a=u[s-1]^u[s-1]>>>30;u[s]=0|(t=r.F,i=void 0,o=void 0,(i=65535&t)*(o=65535&(n=a))+(i*(n>>>16&65535)+(t>>>16&65535)*o<<16)+s)}return u},r.from=function(e){return new r(r.seeded(e),r.N)},r.prototype.min=function(){return r.min},r.prototype.max=function(){return r.max},r.prototype.next=function(){var e,t=this.states[this.index];return t^=this.states[this.index]>>>r.U,t^=t<<r.S&r.B,t^=t<<r.T&r.C,t^=t>>>r.L,[(e=t,(0|e)>=0?0|e:4294967296+(0|e)),new r(this.states,this.index+1)]},r.min=0,r.max=4294967295,r.N=624,r.M=397,r.R=31,r.A=2567483615,r.F=1812433253,r.U=11,r.S=7,r.B=2636928640,r.T=15,r.C=4022730752,r.L=18,r.MASK_LOWER=Math.pow(2,r.R)-1,r.MASK_UPPER=Math.pow(2,r.R),r}(),X=function(r){return I.from(r)},P=function(){function r(r,e,t,n){this.s01=r,this.s00=e,this.s11=t,this.s10=n}return r.prototype.min=function(){return-2147483648},r.prototype.max=function(){return 2147483647},r.prototype.next=function(){var e=this.s00^this.s00<<23,t=this.s01^(this.s01<<23|this.s00>>>9),n=e^this.s10^(e>>>17|t<<15)^(this.s10>>>26|this.s11<<6),i=t^this.s11^t>>>17^this.s11>>>26;return[n+this.s10|0,new r(this.s11,this.s10,i,n)]},r}(),k=function(r){return new P(-1,~r,0,0|r)};function O(r,e,t){for(var n=BigInt(t.min()),i=BigInt(t.max()-t.min()+1),o=i,u=BigInt(1);o<e;)o*=i,++u;for(var s=o-o%e,a=t;;){for(var c=BigInt(0),f=BigInt(0);f!==u;++f){var g=a.next();c=i*c+(BigInt(g[0])-n),a=g[1]}if(c<s)return[c-e*(c/e)+r,a]}}function D(r,e,t){var n=e-r+BigInt(1);return null!=t?O(r,n,t):function(e){return O(r,n,e)}}function E(r,e,t){var n=t.min(),i=t.max()-t.min()+1;if(e<=i)for(var o=t,u=i-i%e;;){var s=(p=o.next())[0]-n;if(o=p[1],s<u)return[s%e+r,o]}for(var a=1,c=0;a<e;)a*=i,++c;for(var f=e*Math.floor(1*a/e),g=t;;){for(var m=0,d=0;d!==c;++d){var p;m=i*m+((p=g.next())[0]-n),g=p[1]}if(m<f)return[m-e*Math.floor(1*m/e)+r,g]}}function N(r,e,t){var n=e-r+1;return null!=t?E(r,n,t):function(e){return E(r,n,e)}}var M,B=n;!function(r){r[r.Released=0]="Released",r[r.Pressed=1]="Pressed"}(M||(M={}));var q,F,Y,j={memory:Uint8Array.from({length:4096}),vRegisters:Uint8Array.from({length:16}),indexRegister:0,programCounter:512,graphics:Uint8Array.from({length:2048}),delayTimer:0,soundTimer:0,stack:Uint16Array.from({length:16}),stackPointer:0,keyState:Array.from({length:16},function(){return 0}),randomGenerator:B.congruential(0),audioFlag:!1,error:null},K=((q={})[1]=1,q[2]=2,q[3]=3,q[4]=12,q.q=4,q.w=5,q.e=6,q.r=13,q.a=7,q.s=8,q.d=9,q.f=14,q.z=10,q.x=0,q.c=11,q.v=15,q),U=["15PUZZLE","BLINKY","BRIX","CONNECT4","GUESS","HIDDEN","INVADERS","KALEID","MAZE","MERLIN","MISSLE","PONG","PONG2","PUZZLE","SYZYGY","TANK","TETRIS","TICTAC","UFO","VBRIX","VERS","WIPEOFF"],L=Uint8Array.from([240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]),G=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return Object.assign.apply(Object,y([Uint8Array.from({length:r.length}),r],e))},_=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[i],t)),programCounter:u+2})},Z=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]|o[i],t)),programCounter:u+2})},z=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]&o[i],t)),programCounter:u+2})},V=function(r,e){var t,n=e.registerX,i=e.twoDigitConstant,o=r.vRegisters,u=r.programCounter,s=r.randomGenerator,a=h(B.uniformIntDistribution(0,255)(s),2),c=a[0],f=a[1];return p({},r,{vRegisters:G(o,(t={},t[n]=c&i,t)),randomGenerator:f,programCounter:u+2})},W=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]^o[i],t)),programCounter:u+2})},H=function(r,e){var t,n=e.registerX,i=r.vRegisters,o=r.programCounter;return p({},r,{vRegisters:G(i,(t={},t[n]=i[n]>>>1,t[15]=1&i[n],t)),programCounter:o+2})},J=function(r,e){var t,n=e.registerX,i=r.vRegisters,o=r.programCounter;return p({},r,{vRegisters:G(i,(t={},t[n]=i[n]<<1,t[15]=i[n]>>>7,t)),programCounter:o+2})},Q=function(r,e){var t=e.registerX,n=e.twoDigitConstant,i=r.vRegisters,o=r.programCounter;return p({},r,{programCounter:i[t]===n?o+4:o+2})},$=function(r,e){var t=e.registerX,n=e.twoDigitConstant,i=r.vRegisters,o=r.programCounter;return p({},r,{programCounter:i[t]!==n?o+4:o+2})},rr=function(r,e){var t=e.registerX,n=e.registerY,i=r.vRegisters,o=r.programCounter;return p({},r,{programCounter:i[t]===i[n]?o+4:o+2})},er=function(r,e){var t=e.registerX,n=e.registerY,i=r.vRegisters,o=r.programCounter;return p({},r,{programCounter:i[t]!==i[n]?o+4:o+2})},tr=function(r,e){var t,n=e.registerX,i=e.twoDigitConstant,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=i,t)),programCounter:u+2})},nr=function(r,e){var t,n=e.registerX,i=e.twoDigitConstant,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]+i,t)),programCounter:u+2})},ir=function(r){var e=r.stack,t=r.stackPointer,n=e[e.length-1];return p({},r,{stack:e.slice(0,-1),stackPointer:t-1,programCounter:n+2})},or=function(r,e){var t=e.threeDigitConstant;return p({},r,{programCounter:t})},ur=function(r,e){var t=e.threeDigitConstant,n=r.stack,i=r.stackPointer,o=r.programCounter;return p({},r,{stack:Uint16Array.from(y(Array.from(n),[o])),stackPointer:i+1,programCounter:t})},sr=function(r,e){var t=e.threeDigitConstant,n=r.vRegisters;return p({},r,{programCounter:n[0]+t})},ar=function(r){return p({},r,{graphics:Uint8Array.from({length:2048}),programCounter:r.programCounter+2})},cr=function(r,e){var t,n,i,o,u=e.oneDigitConstant,s=e.registerX,a=e.registerY,c=r.graphics,f=r.vRegisters,g=r.programCounter,m=f[s],d=f[a],l=(n=u,i=Array.from(Array(8).keys()),o=Array.from(Array(n).keys()),[].concat.apply([],i.map(function(r){return o.map(function(e){return{columnOffset:r,rowOffset:e}})}))).map(function(r,e,t){return function(n){var i=n.rowOffset,o=n.columnOffset,u=r.graphics,s=r.memory,a=r.indexRegister,c=(e+o)%64+(t+i)%32*64,f=u[c],g=(s[a+i]&128>>>o)>>>7-o;return{index:c,result:f^g,collision:1===f&&1===g}}}(r,m,d));return p({},r,{graphics:G.apply(void 0,y([c],l.map(function(r){var e,t=r.index,n=r.result;return(e={})[t]=n,e}))),vRegisters:G(f,(t={},t[15]=l.some(function(r){return r.collision})?1:0,t)),programCounter:g+2})},fr=function(r,e){var t=e.registerX,n=r.keyState,i=r.programCounter,o=r.vRegisters;return p({},r,{programCounter:n[o[t]]===M.Pressed?i+4:i+2})},gr=function(r,e){var t=e.registerX,n=r.keyState,i=r.programCounter,o=r.vRegisters;return p({},r,{programCounter:n[o[t]]===M.Released?i+4:i+2})},mr=function(r,e){var t,n=e.registerX,i=r.keyState,o=r.programCounter,u=r.vRegisters,s=i.findIndex(function(r){return r===M.Pressed});return-1!==s?p({},r,{vRegisters:G(u,(t={},t[n]=s,t)),programCounter:o+2}):r},dr=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]+o[i],t[15]=o[i]>255-o[n]?1:0,t)),programCounter:u+2})},pr=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[n]-o[i],t[15]=o[i]>o[n]?0:1,t)),programCounter:u+2})},lr=function(r,e){var t,n=e.registerX,i=e.registerY,o=r.vRegisters,u=r.programCounter;return p({},r,{vRegisters:G(o,(t={},t[n]=o[i]-o[n],t[15]=o[n]>o[i]?0:1,t)),programCounter:u+2})},vr=function(r,e){var t=e.threeDigitConstant,n=r.programCounter;return p({},r,{indexRegister:t,programCounter:n+2})},hr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter,o=r.indexRegister;return p({},r,{indexRegister:o+n[t],programCounter:i+2})},yr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter,o=r.indexRegister,u=r.memory,s=Array.from(n.slice(0,t+1));return p({},r,{memory:G.apply(void 0,y([u],s.map(function(r,e){var t;return(t={})[o+e]=r,t}))),programCounter:i+2})},Rr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter,o=r.indexRegister,u=r.memory,s=t+1,a=Array.from(u.slice(o,o+s));return p({},r,{vRegisters:G.apply(void 0,y([n],a.map(function(r,e){var t;return(t={})[e]=r,t}))),programCounter:i+2})},Cr=function(r,e){var t,n=e.registerX,i=r.vRegisters,o=r.programCounter,u=r.indexRegister,s=r.memory;return p({},r,{memory:G(s,(t={},t[u]=i[n]/100,t[u+1]=i[n]/10%10,t[u+2]=i[n]%100%10,t)),programCounter:o+2})},wr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter;return p({},r,{indexRegister:5*n[t],programCounter:i+2})},xr=function(r,e){var t,n=e.registerX,i=r.vRegisters,o=r.delayTimer,u=r.programCounter;return p({},r,{vRegisters:G(i,(t={},t[n]=o,t)),programCounter:u+2})},Tr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter;return p({},r,{delayTimer:n[t],programCounter:i+2})},Sr=function(r,e){var t=e.registerX,n=r.vRegisters,i=r.programCounter;return p({},r,{soundTimer:n[t],programCounter:i+2})},Ar=p({},i,o,u,s,a,c,f,g,m,d),br=function(r){var e=r.memory,t=r.programCounter;return e[t]<<8|e[t+1]},Ir=function(r){return{oneDigitConstant:15&r,twoDigitConstant:255&r,threeDigitConstant:4095&r,registerX:(3840&r)>>>8,registerY:(240&r)>>>4}},Xr=function(r,e){return p({},r,{error:"Opcode is not recognized: "+e.toString(16)})},Pr=function(r){return function(e){return p({},e,{randomGenerator:B.congruential(r)})}},kr=function(r){return p({},r,{memory:G.apply(void 0,y([r.memory],Array.from(L).map(function(r,e){var t;return(t={})[e]=r,t})))})},Or=function(r){return function(e){return p({},e,{memory:G.apply(void 0,y([e.memory],Array.from(r).map(function(r,e){var t;return(t={})[e+512]=r,t})))})}},Dr={initializeChip8:function(r,e){return(t=Pr(e),n=kr,i=Or(r),function(r){return i(n(t(r)))})(j);var t,n,i},emulateCpuCycle:(F=function(r){var e=br(r),t=Ir(e);switch(61440&e){case 0:switch(15&e){case 0:return Ar.clearScreen(r);case 14:return Ar.returnFromSubroutine(r);default:return Xr(r,e)}case 4096:return Ar.jumpToAddress(r,t);case 8192:return Ar.callSubroutine(r,t);case 12288:return Ar.registerEqualsConstant(r,t);case 16384:return Ar.registerDoesNotEqualConstant(r,t);case 20480:return Ar.registersAreEqual(r,t);case 24576:return Ar.setRegisterToConstant(r,t);case 28672:return Ar.addConstantToRegister(r,t);case 32768:switch(15&e){case 0:return Ar.assignToRegister(r,t);case 1:return Ar.bitwiseOr(r,t);case 2:return Ar.bitwiseAnd(r,t);case 3:return Ar.bitwiseXor(r,t);case 4:return Ar.addTwoRegisters(r,t);case 5:return Ar.registerXMinusRegisterY(r,t);case 6:return Ar.shiftRight(r,t);case 7:return Ar.registerYMinusRegisterX(r,t);case 14:return Ar.shiftLeft(r,t);default:return Xr(r,e)}case 36864:return Ar.registersAreNotEqual(r,t);case 40960:return Ar.setIndexRegisterToAddress(r,t);case 45056:return Ar.jumpToAddressPlusRegisterZero(r,t);case 49152:return Ar.randomBitwiseAnd(r,t);case 53248:return Ar.drawGraphics(r,t);case 57344:switch(15&e){case 14:return Ar.keyIsPressed(r,t);case 1:return Ar.keyIsNotPressed(r,t);default:return Xr(r,e)}case 61440:switch(255&e){case 7:return Ar.setRegisterToDelayTimer(r,t);case 10:return Ar.awaitKeyPress(r,t);case 21:return Ar.setDelayTimerToRegister(r,t);case 24:return Ar.setSoundTimerToRegister(r,t);case 30:return Ar.addRegisterXToIndexRegister(r,t);case 41:return Ar.storeSpriteLocation(r,t);case 51:return Ar.storeBCD(r,t);case 85:return Ar.registerDump(r,t);case 101:return Ar.registerLoad(r,t);default:return Xr(r,e)}default:return Xr(r,e)}},Y=function(r){return p({},r,{delayTimer:r.delayTimer>0?r.delayTimer-1:r.delayTimer,soundTimer:r.soundTimer>0?r.soundTimer-1:r.soundTimer,audioFlag:1===r.soundTimer})},function(r){return Y(F(r))}),pressKey:function(r,e){var t,n=K[e];return n?p({},r,{keyState:Object.assign(y(r.keyState),(t={},t[n]=M.Pressed,t))}):r},releaseKey:function(r,e){var t,n=K[e];return n?p({},r,{keyState:Object.assign(y(r.keyState),(t={},t[n]=M.Released,t))}):r},turnOffAudioFlag:function(r){return p({},r,{audioFlag:!1})}},Er=function(r){r.fillStyle="#000000",r.fillRect(0,0,64,32)},Nr=Er,Mr=function(r,e){Er(e);for(var t=0;t<r.length;t++)if(r[t]){var n=t%64,i=Math.floor(t/64);e.fillStyle="#80ff80",e.fillRect(n,i,1,1)}},Br=function(r){var e=r.createOscillator(),t=r.createGain();e.connect(t),e.frequency.setTargetAtTime(400,r.currentTime,.01),t.connect(r.destination),t.gain.setTargetAtTime(1,r.currentTime,.01),e.start(r.currentTime),e.stop(r.currentTime+.1)},qr=function(r){return l(void 0,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,fetch("/roms/"+r)];case 1:return[4,t.sent().arrayBuffer()];case 2:return e=t.sent(),[2,new Uint8Array(e)]}})})},Fr=function(){return Math.floor(1e3*Math.random())},Yr="games-dropdown",jr="game-selection-form",Kr="playing-field",Ur="selected-game",Lr=function(r){U.map(function(r){return new Option(r,r)}).forEach(function(e){r.options.add(e)})},Gr=function(r,e,t,n){return function(){var i=new FormData(n).get(Ur);return r.reset(),r.startGame({gameName:i,canvasContext:e,audioContext:t}),!1}},_r=function(r){return function(e){r.pressKey(e.key)}},Zr=function(r){return function(e){r.releaseKey(e.key)}};window.onload=function(r){return function(){var e=r.getElementById(Yr);Lr(e);var t={chip8State:j,animationRequestId:void 0,pressKey:function(r){this.chip8State=this.animationRequestId?Dr.pressKey(this.chip8State,r):this.chip8State},releaseKey:function(r){this.chip8State=this.animationRequestId?Dr.releaseKey(this.chip8State,r):this.chip8State},startGame:function(r){var e=r.gameName,t=r.canvasContext,n=r.audioContext;return l(this,void 0,void 0,function(){var r,i,o=this;return v(this,function(u){switch(u.label){case 0:return[4,qr(e)];case 1:return r=u.sent(),i=Fr(),this.chip8State=Dr.initializeChip8(r,i),this.animationRequestId=requestAnimationFrame(function(){return o.stepFrame(t,n)}),[2]}})})},stepFrame:function(r,e){for(var t=this,n=0;n<10;n++)this.chip8State=Dr.emulateCpuCycle(this.chip8State),this.chip8State.audioFlag&&(Br(e),this.chip8State=Dr.turnOffAudioFlag(this.chip8State));Mr(this.chip8State.graphics,r),this.animationRequestId=requestAnimationFrame(function(){return t.stepFrame(r,e)})},reset:function(){this.animationRequestId&&(window.cancelAnimationFrame(this.animationRequestId),this.chip8State=j,this.animationRequestId=void 0)}},n=r.getElementById(jr),i=r.getElementById(Kr).getContext("2d");Nr(i);var o=new AudioContext;n.onsubmit=Gr(t,i,o,n),r.onkeypress=_r(t),r.onkeyup=Zr(t)}}(document)}]);
//# sourceMappingURL=main.js.map